{
  "resourceType": "Questionnaire",
  "id": "SubstanceUse",
  "meta": {
    "profile": [
      "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-render",
      "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-modular",
      "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-pop-exp"
    ]
  },
  "url": "http://www.health.gov.au/assessments/mbs/715/SubstanceUse",
  "title": "Aboriginal and Torres Strait Islander Health Check - Substance Use",
  "description": "Substance Use sub-questionnaire for Aboriginal and Torres Strait Islander Health Check.",
  "item": [
    {
      "extension": [
        {
          "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-enableWhenExpression",
          "valueExpression": {
            "language": "text/fhirpath",
            "expression": "%age >= 12"
          }
        }
      ],
      "item": [
        {
          "extension": [
            {
              "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
              "valueCodeableConcept": {
                "coding": [
                  {
                    "code": "context-display",
                    "system": "https://smartforms.csiro.au/ig/CodeSystem/QuestionnaireItemControlExtended"
                  }
                ]
              }
            }
          ],
          "linkId": "CD-in-progress-29",
          "text": "In progress",
          "_text": {
            "extension": [
              {
                "url": "http://hl7.org/fhir/StructureDefinition/rendering-xhtml",
                "valueString": "<div title=\"In progress\" xmlns=\"http://www.w3.org/1999/xhtml\">\r\n\t<div style=\"display: flex; flex-direction: row;\">\r\n\t\t<img width='24' height='24' src='data:image/svg+xml;base64,\r\n\t\tPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9IiM3NTc1NzUiIGQ9Im0xNS44NCAxMC4ybC0xLjAxIDEuMDFsLTIuMDctMi4wM2wxLjAxLTEuMDJjLjItLjIxLjU0LS4yMi43OCAwbDEuMjkgMS4yNWMuMjEuMjEuMjIuNTUgMCAuNzlNOCAxMy45MWw0LjE3LTQuMTlsMi4wNyAyLjA4bC00LjE2IDQuMkg4di0yLjA5TTEzIDJ2MmM0LjM5LjU0IDcuNSA0LjUzIDYuOTYgOC45MkE4LjAxNCA4LjAxNCAwIDAgMSAxMyAxOS44OHYyYzUuNS0uNiA5LjQ1LTUuNTQgOC44NS0xMS4wM0MyMS4zMyA2LjE5IDE3LjY2IDIuNSAxMyAybS0yIDBjLTEuOTYuMTgtMy44MS45NS01LjMzIDIuMkw3LjEgNS43NGMxLjEyLS45IDIuNDctMS40OCAzLjktMS42OHYtMk00LjI2IDUuNjdBOS44MSA5LjgxIDAgMCAwIDIuMDUgMTFoMmMuMTktMS40Mi43NS0yLjc3IDEuNjQtMy45TDQuMjYgNS42N00yLjA2IDEzYy4yIDEuOTYuOTcgMy44MSAyLjIxIDUuMzNsMS40Mi0xLjQzQTguMDAyIDguMDAyIDAgMCAxIDQuMDYgMTNoLTJtNSA1LjM3bC0xLjM5IDEuMzdBOS45OTQgOS45OTQgMCAwIDAgMTEgMjJ2LTJhOC4wMDIgOC4wMDIgMCAwIDEtMy45LTEuNjNoLS4wNFoiLz48L3N2Zz4=' \r\n\t\tstyle=\"align-self: center;\"/>\r\n\t</div>\r\n</div>"
              }
            ]
          },
          "type": "display",
          "enableWhen": [
            {
              "question": "MarkComplete-29",
              "operator": "!=",
              "answerBoolean": true
            }
          ]
        },
        {
          "extension": [
            {
              "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
              "valueCodeableConcept": {
                "coding": [
                  {
                    "code": "context-display",
                    "system": "https://smartforms.csiro.au/ig/CodeSystem/QuestionnaireItemControlExtended"
                  }
                ]
              }
            }
          ],
          "linkId": "CD-complete-29",
          "text": "Complete",
          "_text": {
            "extension": [
              {
                "url": "http://hl7.org/fhir/StructureDefinition/rendering-xhtml",
                "valueString": "<div title=\"Section completed\" xmlns=\"http://www.w3.org/1999/xhtml\">\r\n\t<div style=\"display: flex; flex-direction: row;\">\r\n\t\t<img width='24' height='24' src='data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGZpbGw9IiMyZTdkMzIiIGQ9Ik0yMCAxMmE4IDggMCAwIDEtOCA4YTggOCAwIDAgMS04LThhOCA4IDAgMCAxIDgtOGMuNzYgMCAxLjUuMTEgMi4yLjMxbDEuNTctMS41N0E5LjgyMiA5LjgyMiAwIDAgMCAxMiAyQTEwIDEwIDAgMCAwIDIgMTJhMTAgMTAgMCAwIDAgMTAgMTBhMTAgMTAgMCAwIDAgMTAtMTBNNy45MSAxMC4wOEw2LjUgMTEuNUwxMSAxNkwyMSA2bC0xLjQxLTEuNDJMMTEgMTMuMTdsLTMuMDktMy4wOVoiLz48L3N2Zz4='\r\n\t\tstyle=\"align-self: center;\"/>\r\n\t</div>\r\n</div>"
              }
            ]
          },
          "type": "display",
          "enableWhen": [
            {
              "question": "MarkComplete-29",
              "operator": "=",
              "answerBoolean": true
            }
          ]
        },
        {
          "linkId": "RecordUpdate-SubstanceUse",
          "text": "Important: The patient record may not be updated with information entered here. Information intended for the patient record should be entered there first.",
          "_text": {
            "extension": [
              {
                "url": "http://hl7.org/fhir/StructureDefinition/rendering-xhtml",
                "valueString": "<div xmlns=\"http://www.w3.org/1999/xhtml\">\r\n    <strong>Important:</strong> <em>The patient record may not be updated with information entered here. Information intended for the patient record should be entered there first.</em>\r\n    </div>"
              }
            ]
          },
          "type": "display"
        },
        {
          "item": [
            {
              "extension": [
                {
                  "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression",
                  "valueExpression": {
                    "language": "text/fhirpath",
                    "expression": "%ObsTobaccoSmokingStatus.entry.resource.value.coding.where(system='http://snomed.info/sct')"
                  }
                },
                {
                  "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
                  "valueCodeableConcept": {
                    "coding": [
                      {
                        "code": "radio-button",
                        "system": "http://hl7.org/fhir/questionnaire-item-control"
                      }
                    ]
                  }
                }
              ],
              "linkId": "b639a3a8-f476-4cc8-b5c7-f5d2abb23511",
              "text": "Smoking status",
              "type": "choice",
              "repeats": false,
              "answerValueSet": "#TobaccoUseStatus-1"
            },
            {
              "extension": [
                {
                  "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
                  "valueCodeableConcept": {
                    "coding": [
                      {
                        "code": "radio-button",
                        "system": "http://hl7.org/fhir/questionnaire-item-control"
                      }
                    ]
                  }
                }
              ],
              "linkId": "96dc7c22-d003-459c-8a56-f6cd182fc077",
              "text": "Quit status",
              "type": "choice",
              "repeats": false,
              "enableWhen": [
                {
                  "question": "b639a3a8-f476-4cc8-b5c7-f5d2abb23511",
                  "operator": "=",
                  "answerCoding": {
                    "code": "8517006",
                    "system": "http://snomed.info/sct"
                  }
                }
              ],
              "answerValueSet": "#SmokingQuitStatus-1"
            },
            {
              "linkId": "9e86387d-1be4-4c26-9047-9dd6b03e1ee0",
              "text": "How many?",
              "type": "string",
              "repeats": false,
              "enableWhen": [
                {
                  "question": "b639a3a8-f476-4cc8-b5c7-f5d2abb23511",
                  "operator": "=",
                  "answerCoding": {
                    "code": "77176002",
                    "system": "http://snomed.info/sct"
                  }
                },
                {
                  "question": "b639a3a8-f476-4cc8-b5c7-f5d2abb23511",
                  "operator": "=",
                  "answerCoding": {
                    "code": "8517006",
                    "system": "http://snomed.info/sct"
                  }
                },
                {
                  "question": "b639a3a8-f476-4cc8-b5c7-f5d2abb23511",
                  "operator": "=",
                  "answerCoding": {
                    "code": "394872000",
                    "system": "http://snomed.info/sct"
                  }
                }
              ],
              "enableBehavior": "any"
            },
            {
              "linkId": "32e71641-f660-4ca2-af99-dff8917f07be",
              "text": "How long as a smoker?",
              "type": "string",
              "enableWhen": [
                {
                  "question": "b639a3a8-f476-4cc8-b5c7-f5d2abb23511",
                  "operator": "=",
                  "answerCoding": {
                    "code": "77176002",
                    "system": "http://snomed.info/sct"
                  }
                },
                {
                  "question": "b639a3a8-f476-4cc8-b5c7-f5d2abb23511",
                  "operator": "=",
                  "answerCoding": {
                    "code": "8517006",
                    "system": "http://snomed.info/sct"
                  }
                },
                {
                  "question": "b639a3a8-f476-4cc8-b5c7-f5d2abb23511",
                  "operator": "=",
                  "answerCoding": {
                    "code": "394872000",
                    "system": "http://snomed.info/sct"
                  }
                }
              ],
              "enableBehavior": "any"
            }
          ],
          "linkId": "515eda6e-973a-4b10-910a-0d4bf4f2efff",
          "text": "Smoking",
          "type": "group",
          "repeats": false
        },
        {
          "item": [
            {
              "extension": [
                {
                  "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-shortText",
                  "valueString": "Quantity and frequency of substance use"
                }
              ],
              "item": [
                {
                  "extension": [
                    {
                      "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
                      "valueCodeableConcept": {
                        "coding": [
                          {
                            "code": "prompt",
                            "system": "http://hl7.org/fhir/questionnaire-item-control"
                          }
                        ]
                      }
                    }
                  ],
                  "linkId": "232cf24c-db60-4601-869d-525fb6e05988",
                  "text": "details",
                  "type": "display"
                }
              ],
              "linkId": "ea73d52c-f831-46be-a45d-2c42250a5210",
              "text": "Quantity and frequency of: alcohol; caffeine (coffee, soft drinks, iced coffee); cannabis/yarndi/gunja; other substance use: IVDU, methamphetamine, opiates, solvents, other",
              "_text": {
                "extension": [
                  {
                    "url": "http://hl7.org/fhir/StructureDefinition/rendering-xhtml",
                    "valueString": "<div xmlns=\"http://www.w3.org/1999/xhtml\">\r\n        <div>Quantity and frequency of:</div>\r\n        <ul>\r\n          <li>alcohol</li>\r\n          <li>caffeine (coffee, soft drinks, iced coffee)</li>\r\n          <li>cannabis/yarndi/gunja</li>\r\n          <li>other substance use: IVDU, methamphetamine, opiates, solvents, other</li>\r\n        </ul>\r\n\t      </div>"
                  }
                ]
              },
              "type": "text",
              "repeats": false
            }
          ],
          "linkId": "34feaee8-8088-43ee-991d-9729990b5550",
          "text": "Alcohol and other substance use",
          "type": "group",
          "repeats": false
        },
        {
          "linkId": "f8e1cc1f-f1a1-4eb3-8255-77d600f52831",
          "text": "Health priorities, actions and follow-up",
          "type": "text",
          "repeats": false
        },
        {
          "linkId": "MarkComplete-29",
          "text": "Mark section as complete",
          "_text": {
            "extension": [
              {
                "url": "http://hl7.org/fhir/StructureDefinition/rendering-xhtml",
                "valueString": "<div xmlns=\"http://www.w3.org/1999/xhtml\">\r\n<head>\r\n    <style type=\"text/css\">\r\n        .alert {\r\n            padding: 0.875rem;\r\n            margin-bottom: 1rem;\r\n            font-size: 0.875rem;\r\n            color: #2E7D32;\r\n            border-radius: 0.5rem;\r\n            background-color: #d5e5d6;\r\n            font-weight: 700;\r\n        }\r\n    </style>\r\n</head>\r\n<body>\r\n<div class=\"alert\">Mark section as complete</div>\r\n</body>\r\n</div>"
              }
            ]
          },
          "type": "boolean",
          "repeats": false
        }
      ],
      "linkId": "14a9fb5f-5b0e-4862-b143-08a11cd3ebf0",
      "text": "Substance use, including tobacco",
      "type": "group",
      "repeats": false
    }
  ],
  "contained": [
    {
      "resourceType": "ValueSet",
      "id": "SmokingQuitStatus-1",
      "status": "draft",
      "name": "SmokingQuitStatus",
      "title": "Smoking Quit Status",
      "description": "The Smoking Quit Status value set includes values that can indicate how long ago an individual quit smoking.",
      "url": "https://smartforms.csiro.au/ig/ValueSet/SmokingQuitStatus-1",
      "experimental": false,
      "extension": [
        {
          "url": "http://hl7.org/fhir/StructureDefinition/valueset-supplement",
          "valueCanonical": "https://smartforms.csiro.au/ig/CodeSystem/HealthChecksSCTSupplement"
        }
      ],
      "expansion": {
        "identifier": "urn:uuid:86b4329d-aca5-4e54-9b5e-67296c7ce9db",
        "timestamp": "2024-04-08T12:56:59+10:00",
        "total": 2,
        "parameter": [
          {
            "name": "version",
            "valueUri": "http://snomed.info/sct|http://snomed.info/sct/32506021000036107/version/20240331"
          },
          {
            "name": "used-codesystem",
            "valueUri": "http://snomed.info/sct|http://snomed.info/sct/32506021000036107/version/20240331"
          }
        ],
        "contains": [
          {
            "system": "http://snomed.info/sct",
            "code": "48031000119106",
            "display": "Quit >12 months"
          },
          {
            "system": "http://snomed.info/sct",
            "code": "735128000",
            "display": "Quit <12 months"
          }
        ]
      },
      "compose": {
        "include": [
          {
            "system": "http://snomed.info/sct",
            "concept": [
              {
                "code": "48031000119106",
                "display": "Quit >12 months"
              },
              {
                "code": "735128000",
                "display": "Quit <12 months"
              }
            ]
          }
        ]
      }
    },
    {
      "resourceType": "ValueSet",
      "id": "TobaccoUseStatus-1",
      "status": "draft",
      "name": "TobaccoUseStatus",
      "title": "Tobacco Use Status",
      "description": "The Tobacco Use Status value set includes values that may be used to represent an individual's current tobacco use and exposure status.",
      "url": "https://smartforms.csiro.au/ig/ValueSet/TobaccoUseStatus-1",
      "experimental": false,
      "extension": [
        {
          "url": "http://hl7.org/fhir/StructureDefinition/valueset-supplement",
          "valueCanonical": "https://smartforms.csiro.au/ig/CodeSystem/HealthChecksSCTSupplement"
        }
      ],
      "expansion": {
        "identifier": "urn:uuid:577a997d-bacd-499f-bae4-aa6efdcca45e",
        "timestamp": "2024-11-29T10:37:34+10:00",
        "parameter": [
          {
            "name": "version",
            "valueUri": "http://snomed.info/sct|http://snomed.info/sct/32506021000036107/version/20241130"
          },
          {
            "name": "used-codesystem",
            "valueUri": "http://snomed.info/sct|http://snomed.info/sct/32506021000036107/version/20241130"
          }
        ],
        "contains": [
          {
            "system": "http://snomed.info/sct",
            "code": "266919005",
            "display": "Never smoked"
          },
          {
            "system": "http://snomed.info/sct",
            "code": "77176002",
            "display": "Current smoker"
          },
          {
            "system": "http://snomed.info/sct",
            "code": "8517006",
            "display": "Ex-smoker"
          },
          {
            "system": "http://snomed.info/sct",
            "code": "16090371000119103",
            "display": "Exposure to second hand tobacco smoke"
          },
          {
            "system": "http://snomed.info/sct",
            "code": "394872000",
            "display": "Wants to quit"
          },
          {
            "system": "http://snomed.info/sct",
            "code": "713914004",
            "display": "Other tobacco use"
          }
        ]
      },
      "compose": {
        "include": [
          {
            "system": "http://snomed.info/sct",
            "concept": [
              {
                "code": "266919005",
                "display": "Never smoked"
              },
              {
                "code": "77176002",
                "display": "Current smoker"
              },
              {
                "code": "8517006",
                "display": "Ex-smoker"
              },
              {
                "code": "16090371000119103",
                "display": "Exposure to second hand tobacco smoke"
              },
              {
                "code": "394872000",
                "display": "Wants to quit"
              },
              {
                "code": "713914004",
                "display": "Other tobacco use"
              }
            ]
          }
        ]
      }
    }
  ],
  "extension": [
    {
      "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-assemble-expectation",
      "valueCode": "assemble-child"
    },
    {
      "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-launchContext",
      "extension": [
        {
          "url": "name",
          "valueCoding": {
            "code": "patient",
            "system": "http://hl7.org/fhir/uv/sdc/CodeSystem/launchContext"
          }
        },
        {
          "url": "type",
          "valueCode": "Patient"
        },
        {
          "url": "description",
          "valueString": "The patient that is to be used to pre-populate the form"
        }
      ]
    },
    {
      "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-launchContext",
      "extension": [
        {
          "url": "name",
          "valueCoding": {
            "code": "user",
            "system": "http://hl7.org/fhir/uv/sdc/CodeSystem/launchContext"
          }
        },
        {
          "url": "type",
          "valueCode": "Practitioner"
        },
        {
          "url": "description",
          "valueString": "The practitioner user that is to be used to pre-populate the form"
        }
      ]
    },
    {
      "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-launchContext",
      "extension": [
        {
          "url": "name",
          "valueCoding": {
            "code": "encounter",
            "system": "http://hl7.org/fhir/uv/sdc/CodeSystem/launchContext"
          }
        },
        {
          "url": "type",
          "valueCode": "Encounter"
        },
        {
          "url": "description",
          "valueString": "The encounter that is to be used to pre-populate the form"
        }
      ]
    },
    {
      "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-assembleContext",
      "valueString": "age"
    },
    {
      "url": "http://hl7.org/fhir/StructureDefinition/variable",
      "valueExpression": {
        "name": "ObsTobaccoSmokingStatus",
        "language": "application/x-fhir-query",
        "expression": "Observation?code=72166-2&_count=1&_sort=-date&patient={{%patient.id}}"
      }
    }
  ],
  "name": "SubstanceUse",
  "status": "draft",
  "experimental": false,
  "subjectType": [
    "Patient"
  ],
  "date": "2024-04-02",
  "jurisdiction": [
    {
      "coding": [
        {
          "code": "AU",
          "system": "urn:iso:std:iso:3166"
        }
      ]
    }
  ]
}
